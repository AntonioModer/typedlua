\allowdisplaybreaks
\begin{align*}
\textit{chunk} & ::= \; \textit{block}\\
\textit{block} & ::= \; \{\textit{stat}\} \; [\textit{retstat}]\\
\textit{stat} & ::= \; \texttt{`;'}\\
& | \; \textit{varlist} \; \texttt{`='} \; \textit{explist}\\
& | \; \textit{functioncall}\\
& | \; \textit{label}\\
& | \; \textbf{break}\\ 
& | \; \textbf{goto} \; \textit{Name}\\
& | \; \textbf{do} \; \textit{block} \; \textbf{end}\\
& | \; \textbf{while} \; \textit{exp} \; \textbf{do} \; \textit{block} \; \textbf{end}\\
& | \; \textbf{repeat} \; \textit{block} \; \textbf{until} \; \textit{exp}\\
& | \; \textbf{if} \; \textit{exp} \; \textbf{then} \; \textit{block} \;
  \{\textbf{elseif} \; \textit{exp} \; \textbf{then} \; \textit{block}\} \;
  [\textbf{else} \; \textit{block}] \; \textbf{end}\\ 
& | \; \textbf{for} \; \textit{Name} \; \texttt{`='} \; \textit{exp} \;
  \texttt{`,'} \; \textit{exp} \; [\texttt{`,'} \; \textit{exp}] \;
  \textbf{do} \; \textit{block} \; \textbf{end}\\
& | \; \textbf{for} \; \textit{namelist} \; \textbf{in} \; \textit{explist} \;
  \textbf{do} \; \textit{block} \; \textbf{end}\\
& | \; \textcolor{blue}{[\textbf{const}]} \; \textbf{function} \; \textit{funcname} \; \textit{funcbody}\\
& | \; \textbf{local} \; \textbf{function} \; \textit{Name} \; \textit{funcbody}\\
& | \; \textbf{local} \; \textit{namelist} \; [\texttt{`='} \; \textit{explist}]\\
& | \; \textcolor{blue}{[\textbf{local}] \; \textbf{interface} \; \textit{Name} \; \textit{interfacedec} \;
  \{\textit{interfacedec}\} \; \textbf{end}}\\
\textit{retstat} & ::= \; \textbf{return} \; [\textit{explist}] \; [\texttt{`;'}]\\
\textit{label} & ::= \; \texttt{`::'} \; \textit{Name} \; \texttt{`::'}\\
\textit{funcname} & ::= \; \textit{Name} \; \{\texttt{`.'} \; \textit{Name}\} \; [\texttt{`:'} \; \textit{Name}]\\
\textit{varlist} & ::= \; \textcolor{blue}{[\textbf{const}]} \; \textit{var} \;
  \{\texttt{`,'} \; \textcolor{blue}{[\textbf{const}]} \; \textit{var}\}\\
\textit{var} & ::= \; \textit{Name} \; | \;
  \textit{prefixexp} \; \texttt{`['} \; \textit{exp} \; \texttt{`]'} \; | \;
  \textit{prefixexp} \; \texttt{`.'} \; \textit{Name}\\
\textit{namelist} & ::= \; \textit{Name} \; \textcolor{blue}{[\texttt{`:'} \; \textit{type}]} \;
  \{\texttt{`,'} \; \textit{Name} \; \textcolor{blue}{[\texttt{`:'} \; \textit{type}]}\}\\
\textit{explist} & ::= \; \textit{exp} \; \{\texttt{`,'} \; \textit{exp}\}\\
\textit{exp} & ::= \; \textbf{nil} \; | \;
  \textbf{false} \; | \;
  \textbf{true} \; | \;
  \textit{Number} \; | \;
  \textit{String} \; | \;
  \texttt{`...'} \; | \;
  \textit{functiondef}\\
& | \; \textit{prefixexp} \; | \;
  \textit{tableconstructor} \; | \;
  \textit{exp} \; \textit{binop} \; \textit{exp} \; | \;
  \textit{unop} \; \textit{exp}\\
\textit{prefixexp} & ::= \; \textit{var} \; | \;
  \textit{functioncall} \; | \;
  \texttt{`('} \; \textit{exp} \; \texttt{`)'}\\
\textit{functioncall} & ::= \; \textit{prefixexp} \; \textit{args} \; | \;
  \textit{prefixexp} \; \texttt{`:'} \; \textit{Name} \; \textit{args}\\
\textit{args} & ::= \; \texttt{`('} \; [\textit{explist}] \; \texttt{`)'} \; | \;
  \textit{tableconstructor} \; | \;
  \textit{String}\\
\textit{functiondef} & ::= \; \textbf{function} \; \textit{funcbody}\\
\textit{funcbody} & ::= \; \texttt{`('} \; [\textit{parlist}] \; \texttt{`)'} \;
  \textcolor{blue}{[\texttt{`:'} \; \textit{rettype}]} \; \textit{block} \; \textbf{end}\\
\textit{parlist} & ::= \; \textit{namelist} \; [\texttt{`,'} \; \texttt{`...'} \;
  \textcolor{blue}{[\texttt{`:'} \; \textit{type}]}] \; | \;
  \texttt{`...'} \; \textcolor{blue}{[\texttt{`:'} \; \textit{type}]}\\
\textit{tableconstructor} & ::= \; \texttt{`\{'} \; [\textit{fieldlist}] \; \texttt{`\}'}\\
\textit{fieldlist} & ::= \; \textcolor{blue}{[\textbf{const}]} \; \textit{field} \;
  \{\textit{fieldsep} \; \textcolor{blue}{[\textbf{const}]} \; \textit{field}\} \; [\textit{fieldsep}]\\
\textit{field} & ::= \; \texttt{`['} \; \textit{exp} \; \texttt{`]'} \; \texttt{`='} \; \textit{exp} \; | \;
  \textit{Name} \; \texttt{`='} \; \textit{exp} \; | \;
  \textit{exp}\\
\textit{fieldsep} & ::= \; \texttt{`,'} \; | \; \texttt{`;'}\\
\textit{binop} & ::= \; \texttt{`+'} \; | \; \texttt{`-'} \; | \; \texttt{`*'} \; | \; \texttt{`/'} \; | \;
  \texttt{`\textasciicircum'} \; | \; \texttt{`\%'} \; | \; \texttt{`..'}\\
& | \; \texttt{`<'} \; | \; \texttt{`<='} \; | \; \texttt{`>'} \; | \; \texttt{`>='} \; | \;
  \texttt{`=='} \; | \; \texttt{`\textasciitilde='}\\
& | \; \textbf{and} \; | \; \textbf{or}\\
\textit{unop} & ::= \; \texttt{`-'} \; | \; \textbf{not} \; | \; \texttt{`\#'}\\
\textcolor{blue}{\textit{interfacedec}} & ::= \; [\textbf{const}] \; \textit{Name} \;
  \{\texttt{`,'} \; [\textbf{const}] \; \textit{Name}\} \; \texttt{`:'} \; \textit{dectype}\\
\textcolor{blue}{\textit{dectype}} & ::= \; \textit{type} \; | \; \textit{methodtype}\\
\textcolor{blue}{\textit{type}} & ::= \; \textit{primarytype} \; [\texttt{`?'}]\\
\textcolor{blue}{\textit{primarytype}} & ::= \; \textit{literaltype} \; | \;
  \textit{basetype} \; | \;
  \textbf{nil} \; | \;
  \textbf{value} \; | \;
  \textbf{any} \; | \;
  \textbf{self} \; | \;
  \textit{Name}\\
& | \; \textit{functiontype} \; | \;
  \textit{tabletype} \; | \;
  \textit{primarytype} \; \texttt{`|'} \; \textit{primarytype}\\
\textcolor{blue}{\textit{literaltype}} & ::= \; \textbf{false} \; | \;
  \textbf{true} \; | \;
  \textit{Number} \; | \;
  \textit{String}\\
\textcolor{blue}{\textit{basetype}} & ::= \; \textbf{boolean} \; | \;
  \textbf{number} \; | \;
  \textbf{string}\\
\textcolor{blue}{\textit{functiontype}} & ::= \; \textit{tupletype} \; \texttt{`->'} \; \textit{rettypelist}\\
\textcolor{blue}{\textit{methodtype}} & ::= \; \textit{tupletype} \; \texttt{`=>'} \; \textit{rettypelist}\\
\textcolor{blue}{\textit{tabletype}} & ::= \; \texttt{`\{'} \; [\textit{tabletypebody}] \; \texttt{`\}'}\\
\textcolor{blue}{\textit{tupletype}} & ::= \; \texttt{`('} \; [typelist] \; \texttt{`)'}\\
\textcolor{blue}{\textit{typelist}} & ::= \; \textit{type} \; \{\texttt{`,'} \; \textit{type}\} \; [\texttt{`*'}]\\
\textcolor{blue}{\textit{rettypelist}} & ::= \; \textit{unionlist} \; [\texttt{`?'}]\\
\textcolor{blue}{\textit{unionlist}} & ::= \; \textit{tupletype} \; | \;
  \textit{unionlist} \; \texttt{`|'} \; \textit{unionlist}\\
\textcolor{blue}{\textit{tabletypebody}} & ::= \; \textit{type} \; | \; \textit{fieldtypelist}\\
\textcolor{blue}{\textit{fieldtypelist}} & ::= \; [\textbf{const}] \; \textit{fieldtype} \; \{\texttt{`,'} \; [\textbf{const}] \; \textit{fieldtype}\}\\ 
\textcolor{blue}{\textit{fieldtype}} & ::= \; \textit{keytype} \; \texttt{`:'} \; \textit{type}\\
\textcolor{blue}{\textit{keytype}} & ::= \; \textit{literaltype} \; | \;
  \textit{basetype} \; | \;
  \textbf{value} \; | \;
  \textbf{any}\\
\textcolor{blue}{\textit{rettype}} & ::= \; \textit{type} \; | \; \textit{rettypelist}\\
\end{align*}
